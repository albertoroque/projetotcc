<!DOCTYPE html>
<html>
<head>
	<title></title>
	<meta http-equiv="Content-type" content="text/html;charset=UTF-8" />
	
	<script src="js/jquery.min.js"></script>
	<script src="js/jquery.Jcrop.js"></script>	
	<link rel="stylesheet" href="css/jquery.Jcrop.css" type="text/css" />
</head>
<body>
	<style type="text/css">
		
		.thumbnail-img{
			height: auto;
		    width: 100%;		    		   
		}

		.img-canvas{
			max-width: 500px;
			width: 100%;
			height: auto;		   
		}
		
	</style>
	<div>    	
    	<img id="canvasToThumb" 
    	class='thumbnail-img' 
    	src="http://www.extremetech.com/wp-content/uploads/2012/12/Audi-A1.jpg" />
	</div>
	<button id="crop">Crop</button>	


	<div style="width:600px; height: 600px; background-color: red; ">
		<canvas id="canvasThumbResult"></canvas>
	</div>


	<div style="width:600px; height: 600px; background-color: yellow; ">
		<canvas id="preview"></canvas>
	</div>

	<script>
	// Create variables (in this scope) to hold the API and image size
	var jcrop_api, boundx, boundy;

	var coords;

	function showCoords(c) { // show all coords	    
	    coords = c;
	}

	$('.thumbnail-img').Jcrop({	    
	    onSelect: showCoords,
	    bgFade: true,
	    bgOpacity: .3,	   
	    aspectRatio: 1
	},function(){
	    	  
      // Store the API in the jcrop_api variable
      jcrop_api = this;     
	});

	$("#crop").on("click", function(){
	    
	    var canvas = document.getElementById("canvasThumbResult");
	    
	    var context = canvas.getContext("2d");

	    //espa√µ da imagem cortada
	    var img = document.getElementById("canvasToThumb"),
	    	    	
	    	$img = $(img),
		    imgW = img.width, 
		    imgH = img.height;		   
	    
	    // TAMANHO DA IMAGEM ORIGINAL
	    console.log('IMG W', imgW);
	    console.log('IMG H', imgH);

	    // TAMANHO DA IMAGEM NA DIV
	    console.log('IMG DIV H', $img.height());
	    console.log('IMG DIV W', $img.width());
	    
	    var rY = imgH / $img.height(),
	        rX = imgW / $img.width();
       
        console.log(coords);	       		

	    console.log('---------- COORDS COMPARE');
	    console.log(coords.x * 3);
	    console.log(coords.y * 3);
	    console.log(coords.w * 3);
	    console.log(coords.h * 3);	    

	    context.drawImage
	    	(img, 
	    	coords.x * rX, 
	    	coords.y * rY, 
	    	coords.w * rX, 
	    	coords.h * rY, 
	    	0, 
	    	0, 
	    	600, 
	    	600);

	    var dataUrl = canvas.toDataUrl();
		console.log(dataUrl);

	});


	// document.getElementById('canvasImg').src = dataURL;

	</script>
</body>


</html>